{"ast":null,"code":"// Simple fetch wrapper that sends Authorization header and handles 401 globally\nexport async function fetchWithAuth(url, opts = {}) {\n  const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\n  const headers = Object.assign({}, opts.headers || {});\n  if (token) headers['Authorization'] = `Bearer ${token}`;\n  headers['Content-Type'] = headers['Content-Type'] || 'application/json';\n  const res = await fetch(url, Object.assign({}, opts, {\n    headers\n  }));\n  if (res.status === 401) {\n    // auto logout\n    localStorage.removeItem('token');\n    window.dispatchEvent(new CustomEvent('toast', {\n      detail: {\n        message: 'Session expired - logged out',\n        type: 'error'\n      }\n    }));\n    window.dispatchEvent(new CustomEvent('auth-logout'));\n    return res;\n  }\n  return res;\n}\nexport function setAuthToken(token) {\n  if (token) localStorage.setItem('token', token);else localStorage.removeItem('token');\n}","map":{"version":3,"names":["fetchWithAuth","url","opts","token","window","localStorage","getItem","headers","Object","assign","res","fetch","status","removeItem","dispatchEvent","CustomEvent","detail","message","type","setAuthToken","setItem"],"sources":["C:/Users/LOQ/Documents/mern-hotel/frontend/src/api.js"],"sourcesContent":["// Simple fetch wrapper that sends Authorization header and handles 401 globally\r\nexport async function fetchWithAuth(url, opts = {}){\r\n  const token = typeof window !== 'undefined' ? localStorage.getItem('token') : null;\r\n  const headers = Object.assign({}, opts.headers || {});\r\n  if(token) headers['Authorization'] = `Bearer ${token}`;\r\n  headers['Content-Type'] = headers['Content-Type'] || 'application/json';\r\n  const res = await fetch(url, Object.assign({}, opts, { headers }));\r\n  if(res.status === 401){\r\n    // auto logout\r\n    localStorage.removeItem('token');\r\n    window.dispatchEvent(new CustomEvent('toast', { detail: { message: 'Session expired - logged out', type: 'error' } }));\r\n    window.dispatchEvent(new CustomEvent('auth-logout'));\r\n    return res;\r\n  }\r\n  return res;\r\n}\r\n\r\nexport function setAuthToken(token){\r\n  if(token) localStorage.setItem('token', token);\r\n  else localStorage.removeItem('token');\r\n}\r\n"],"mappings":"AAAA;AACA,OAAO,eAAeA,aAAaA,CAACC,GAAG,EAAEC,IAAI,GAAG,CAAC,CAAC,EAAC;EACjD,MAAMC,KAAK,GAAG,OAAOC,MAAM,KAAK,WAAW,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,GAAG,IAAI;EAClF,MAAMC,OAAO,GAAGC,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAEP,IAAI,CAACK,OAAO,IAAI,CAAC,CAAC,CAAC;EACrD,IAAGJ,KAAK,EAAEI,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUJ,KAAK,EAAE;EACtDI,OAAO,CAAC,cAAc,CAAC,GAAGA,OAAO,CAAC,cAAc,CAAC,IAAI,kBAAkB;EACvE,MAAMG,GAAG,GAAG,MAAMC,KAAK,CAACV,GAAG,EAAEO,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAEP,IAAI,EAAE;IAAEK;EAAQ,CAAC,CAAC,CAAC;EAClE,IAAGG,GAAG,CAACE,MAAM,KAAK,GAAG,EAAC;IACpB;IACAP,YAAY,CAACQ,UAAU,CAAC,OAAO,CAAC;IAChCT,MAAM,CAACU,aAAa,CAAC,IAAIC,WAAW,CAAC,OAAO,EAAE;MAAEC,MAAM,EAAE;QAAEC,OAAO,EAAE,8BAA8B;QAAEC,IAAI,EAAE;MAAQ;IAAE,CAAC,CAAC,CAAC;IACtHd,MAAM,CAACU,aAAa,CAAC,IAAIC,WAAW,CAAC,aAAa,CAAC,CAAC;IACpD,OAAOL,GAAG;EACZ;EACA,OAAOA,GAAG;AACZ;AAEA,OAAO,SAASS,YAAYA,CAAChB,KAAK,EAAC;EACjC,IAAGA,KAAK,EAAEE,YAAY,CAACe,OAAO,CAAC,OAAO,EAAEjB,KAAK,CAAC,CAAC,KAC1CE,YAAY,CAACQ,UAAU,CAAC,OAAO,CAAC;AACvC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}